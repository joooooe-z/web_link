# Onerway支付链接系统需求文档 2.0

## 1. 项目概述

### 1.1 项目背景
Onerway支付链接系统是一个专为商户设计的收款解决方案，通过生成和管理可分享的支付链接，实现快速收款。系统无需商户构建复杂电商网站或深度集成支付网关，即可接收各类支付方式的款项。

### 1.2 目标用户
- **商户**：小型商家、自由职业者、服务提供商和企业
- **客户**：通过链接进行支付的终端消费者

### 1.3 项目目标
1. 为商户提供简单高效的收款工具
2. 支持多元化支付场景（固定金额、动态金额、手动收款）
3. 提供完整的数据分析和交易管理功能
4. 确保高度安全性和可靠性

## 2. 功能需求（详细规格）

### 2.1 商户管理系统

#### 2.1.1 控制台页面
- **统计概览**：展示活跃链接数量、总访问量、总转化次数
- **最近链接**：展示最近创建的支付链接，包含商品编号、名称、金额、创建日期和状态
- **最近交易**：展示最近完成的交易，包含交易ID、商品名称、金额、支付方式和日期
- **创建新链接**：下拉菜单，包含三个选项
  - 支付链接（固定金额）
  - 动态金额付款（客户自定义金额）
  - 手动付款（商户代客户付款）

#### 2.1.2 链接管理页面
- **筛选和搜索**：按状态筛选链接，支持搜索链接名称或ID
- **排序**：支持按创建时间、访问量、交易额排序
- **链接列表**：展示所有链接，包含商品编号、名称、金额、创建日期、状态、访问/转化数据、交易总额
- **操作**：查看详情、启用/禁用、删除链接
- **分页**：支持大量链接的分页显示

#### 2.1.3 链接详情页面
- **基本信息**：显示链接状态、创建时间、金额信息、有效期、商品编号等
- **统计数据**：总访问次数、支付次数、总收款金额
- **交易图表**：显示每日交易金额趋势
- **交易记录**：展示该链接的所有交易
- **链接工具**：复制链接、生成二维码、测试链接、分享到社交媒体

#### 2.1.4 创建支付链接功能
- **基础信息**：
  - 商品名称（必填）
  - 商品描述（仅显示给商户）
  - 商品图片（可选）
  - 商品编号（必填且唯一）
- **金额设置**：
  - 固定金额：设置单价、数量、货币
  - 动态金额：设置最小金额、最大金额、货币
- **高级设置**：
  - 有效期设置：永久有效或指定截止日期
  - 使用次数限制（可选）
  - 支付方式：默认支持所有可用的支付方式

#### 2.1.5 手动付款功能
- **商品信息**：商品名称、商品编号、金额、货币
- **客户信息**：客户姓名、客户邮箱
- **支付卡信息**：卡号、有效期、安全码
- **提交处理**：直接记录交易，无需客户操作

### 2.2 客户支付系统

#### 2.2.1 支付页面
- **商品信息**：
  - 商品名称
  - 商品图片（如有）
  - 价格信息：
    - 固定金额：显示单价、数量、总金额
    - 动态金额：允许客户输入金额，设有最小/最大限制
- **支付方式选择**：
  - 信用卡支付
  - 微信支付
  - 支付宝
- **支付按钮**：确认支付后直接处理交易
- **品牌标识**：显示"安全支付由Onerway提供保障"文本

#### 2.2.2 支付成功页面
- **成功图标**：绿色对勾
- **成功消息**：支付成功提示
- **交易详情**：
  - 交易编号
  - 支付金额
  - 支付时间
  - 支付方式
  - 商品名称
- **操作按钮**：
  - 下载收据（PDF格式）
  - 返回首页
- **客服联系信息**

#### 2.2.3 支付失败页面
- **失败图标**：红色叉号
- **失败消息**：支付失败提示
- **错误详情**：错误原因和错误代码
- **操作按钮**：
  - 重新支付
  - 返回首页
- **客服联系信息**

### 2.3 数据存储与管理

#### 2.3.1 链接数据结构
```javascript
{
  id: "唯一标识符",
  shortId: "短链接ID",
  title: "商品名称",
  description: "商品描述",
  imageUrl: "商品图片URL",
  productCode: "商品编号",
  createdAt: "创建时间",
  status: "ACTIVE/DISABLED/EXPIRED",
  amount: {
    type: "FIXED/DYNAMIC",
    value: 固定金额单价,
    quantity: 商品数量,
    totalValue: 总金额,
    minValue: 最小金额(动态),
    maxValue: 最大金额(动态),
    currency: "货币代码"
  },
  validity: {
    type: "PERMANENT/FIXED",
    endTime: "截止时间",
    maxUsage: 最大使用次数
  },
  paymentMethods: ["支持的支付方式"],
  stats: {
    visits: 访问次数,
    conversions: 转化次数,
    totalAmount: 总交易金额
  }
}
```

#### 2.3.2 交易数据结构
```javascript
{
  id: "交易唯一标识符",
  linkId: "关联的链接ID",
  merchantId: "商户ID",
  amount: 交易金额,
  currency: "货币代码",
  paymentMethod: "支付方式",
  status: "交易状态",
  createdAt: "创建时间",
  productTitle: "商品名称",
  productCode: "商品编号",
  customerInfo: {
    name: "客户姓名",
    email: "客户邮箱",
    card: "卡号末四位(手动付款)"
  }
}
```

## 3. 功能交互流程

### 3.1 创建支付链接流程
1. 商户点击"创建新链接"按钮，展开下拉菜单
2. 选择"支付链接"选项，打开创建支付链接模态框
3. 填写商品信息（名称、描述、图片、商品编号）
4. 选择金额类型（固定/动态）并设置相关参数
5. 配置高级选项（有效期、使用限制）
6. 点击"创建链接"按钮提交
7. 系统验证信息（商品编号唯一性等）并创建链接
8. 关闭模态框并跳转到链接管理页面

### 3.2 手动付款流程
1. 商户点击"创建新链接"按钮，展开下拉菜单
2. 选择"手动付款"选项，打开手动付款模态框
3. 填写商品信息和金额
4. 填写客户信息
5. 输入支付卡信息
6. 点击"处理付款"按钮
7. 系统验证信息并创建交易记录
8. 显示成功提示并刷新页面

### 3.3 动态金额付款流程
1. 商户点击"创建新链接"按钮，展开下拉菜单
2. 选择"动态金额付款"选项，打开动态金额付款模态框
3. 填写商品信息
4. 设置金额范围（最小值和最大值）
5. 配置高级选项
6. 点击"创建链接"按钮
7. 系统验证信息并创建链接
8. 显示成功提示并跳转到链接管理页面

### 3.4 客户支付流程
1. 客户访问支付链接
2. 系统记录访问并显示支付页面
3. 客户查看商品信息：
   - 固定金额显示详细价格信息
   - 动态金额允许输入自定义金额
4. 客户选择支付方式
5. 点击"确认支付"按钮
6. 系统验证金额并处理交易
7. 显示支付成功页面并提供交易详情
8. 可选：下载收据

### 3.5 链接管理流程
1. 商户进入"管理链接"页面
2. 根据需要筛选、搜索或排序链接列表
3. 查看链接基本信息和统计数据
4. 管理操作：
   - 点击链接名称查看详情
   - 点击启用/禁用按钮切换状态
   - 点击删除按钮（需确认）删除链接
5. 使用分页浏览大量链接

## 4. 技术规格

### 4.1 前端技术
- HTML5/CSS3/JavaScript
- Pure CSS 框架（轻量级UI）
- 响应式设计适配各种设备
- LocalStorage用于数据存储

### 4.2 数据存储
- 前端LocalStorage模拟数据存储
- 实际应用中需要后端数据库支持

### 4.3 安全考量
- 使用HTTPS传输
- 商品编号唯一性验证
- 输入数据验证

## 5. 界面要求

### 5.1 总体设计风格
- 简洁现代的设计语言
- 轻量级界面，快速加载
- 一致的色彩方案（主色调：#0066FF）

### 5.2 响应式设计
- 支持桌面、平板和移动设备
- 布局自适应不同屏幕尺寸

### 5.3 交互元素
- 模态框用于表单输入
- 下拉菜单用于功能选择
- 可视化图表显示交易数据
- 表单验证提供即时反馈

## 6. 系统限制

### 6.1 演示版本限制
- 使用LocalStorage模拟数据存储，数据存留在浏览器中
- 不执行实际支付处理
- 不包含用户认证系统

### 6.2 性能限制
- LocalStorage存储容量限制（约5-10MB）
- 前端处理大量数据可能影响性能

## 7. 附加功能

### 7.1 二维码生成
- 为支付链接生成可扫描的二维码

### 7.2 社交媒体分享
- 支持分享链接到WhatsApp、Email、Facebook、Twitter等

### 7.3 交易分析图表
- 显示每日交易金额趋势

## 8. 验收标准

### 8.1 商户功能验收
- 成功创建三种类型的链接（固定金额、动态金额、手动付款）
- 管理链接状态（启用/禁用）和查看统计
- 查看和分析交易数据

### 8.2 客户功能验收
- 顺利完成固定金额支付流程
- 顺利完成动态金额输入和支付流程
- 正确显示交易结果和详情

### 8.3 性能验收
- 页面加载时间<3秒
- 交互响应时间<1秒
- 在主流浏览器中无显示错误

# Onerway支付链接系统需求文档

## 1. 项目概述

### 1.1 项目背景
Onerway支付链接系统是一个专为商户设计的收款解决方案，通过生成和管理可分享的支付链接，实现快速收款。系统无需商户构建复杂电商网站或深度集成支付网关，即可接收各类支付方式的款项。

### 1.2 目标用户
- **商户**：小型商家、自由职业者、服务提供商和企业
- **客户**：通过链接进行支付的终端消费者

### 1.3 项目目标
1. 为商户提供简单高效的收款工具
2. 支持多元化支付场景（固定金额、动态金额）
3. 提供完整的数据分析和交易管理功能
4. 确保高度安全性和可靠性

## 2. 功能需求（详细规格）

### 2.1 商户管理系统

#### 2.1.1 控制台（Dashboard）

**页面布局**：
- 顶部导航栏：包含链接到"控制台"、"创建链接"、"管理链接"页面
- 主要统计卡片区：显示活跃链接数、总访问量、成功支付数的统计卡片
- 最近链接区域：以表格形式展示最近创建的5个链接
- 最近交易区域：以表格形式展示最近5笔交易

**功能元素**：
- **统计卡片**：
  - 活跃链接卡片：显示当前状态为活跃的链接总数
  - 访问量卡片：显示所有链接的总访问次数
  - 支付成功卡片：显示所有成功支付的交易数量
  
- **最近链接表格**：
  - 链接名称（可点击进入详情页）
  - 金额信息（固定金额或标记为"动态金额"）
  - 创建日期（格式化为本地时间）
  - 状态标识（活跃/已禁用/已过期）
  
- **最近交易表格**：
  - 交易ID（部分显示，格式如"TR12345..."）
  - 交易金额（带货币符号）
  - 支付方式（如信用卡、微信支付等）
  - 交易日期时间

**数据更新机制**：
- 页面加载时自动获取最新数据
- 提供"创建新链接"快捷按钮

#### 2.1.2 支付链接创建（Create Link）

**表单布局**：
- 分为基础信息、金额设置和高级设置三个部分

**基础信息部分**：
- **商品名称**：
  - 必填字段，最多50个字符
  - 显示在支付页面顶部
  
- **商品描述**：
  - 选填字段，最多200个字符
  - 显示在支付页面的商品名称下方
  
- **商品图片**：
  - 选填字段，支持JPG/PNG格式上传
  - 最大2MB
  - 在支付页面中央显示

**金额设置部分**：
- **金额类型选择**：
  - 固定金额（默认）：商户设定具体金额
  - 客户自定义金额：允许客户在支付时输入金额
  
- **固定金额设置**：
  - 金额输入框：数字类型，最小0.01
  - 货币选择下拉框：USD/EUR/JPY/CNY
  
- **动态金额设置**：
  - 最小金额：可选限制
  - 最大金额：可选限制
  - 货币选择：同固定金额

**高级设置部分**：
- **有效期设置**：
  - 永久有效（默认）
  - 自定义有效期：日期选择器
  
- **使用次数限制**：
  - 数字输入，留空表示不限制
  
- **支付方式选择**：
  - 信用卡支付（默认选中）
  - Apple Pay
  - 本地支付方式（如微信/支付宝）

**提交机制**：
- 表单验证：提交前验证必填字段
- 成功提示：模态框显示成功信息
- 链接分享：提供复制链接和二维码功能

#### 2.1.3 支付链接管理（Manage Links）

**筛选和搜索功能**：
- **状态筛选**：下拉菜单（全部/活跃/已禁用/已过期）
- **搜索功能**：按链接名称或ID搜索
- **排序功能**：创建时间、访问量、交易额（升序/降序）

**链接列表表格**：
- **列信息**：
  - 名称列：显示链接标题，可点击进入详情
  - 金额列：显示金额信息
  - 创建日期列
  - 状态列：带颜色标识
  - 访问/转化列：显示访问量和支付次数
  - 交易总额列
  - 操作列：包含查看、启用/禁用、删除按钮

**批量操作功能**：
- 分页控制：每页10条记录
- 分页导航：上一页/下一页
- 总记录数显示

**操作确认机制**：
- 禁用/启用确认：模态框确认操作
- 删除确认：带警告信息的模态框

#### 2.1.4 链接详情页（Link Details）

**页面布局**：
- 导航面包屑：控制台 > 管理链接 > 链接详情
- 左侧主内容：详情信息、统计数据、交易记录
- 右侧边栏：收款链接、二维码、操作按钮

**详情信息区域**：
- **链接基本信息**：
  - 标题和状态标识
  - 创建时间
  - 金额类型和金额信息
  - 有效期信息
  - 商品图片（如有）和描述
  
- **统计数据卡片**：
  - 总访问次数
  - 支付次数
  - 总收款金额
  
- **交易图表**：
  - 交易金额柱状图（按日期显示）
  - Y轴显示金额，X轴显示日期
  
- **交易记录表格**：
  - 交易ID
  - 金额
  - 支付方式
  - 时间
  - 状态（成功/处理中）

**收款链接区域**：
- 链接URL显示框（只读）
- 复制链接按钮
- 二维码显示
- 测试链接按钮（新窗口打开支付页面）

**操作按钮组**：
- 分享按钮：打开分享选项（WhatsApp、Email、Facebook、Twitter）
- 启用/禁用按钮：切换链接状态
- 删除按钮：删除链接（需确认）

### 2.2 客户支付流程

#### 2.2.1 支付页面（Payment Page）

**页面布局**：
- 左侧：商品信息区域
- 右侧：支付表单区域

**商品信息区域**：
- 商家Logo展示
- 商品标题（大字体）
- 商品描述文本
- 商品图片（如有上传）
- 金额显示：
  - 固定金额：直接显示带货币符号的金额
  - 动态金额：提供金额输入框，带货币符号前缀

**支付表单区域**：
- **支付方式选择**：
  - 信用卡支付选项：带图标和描述
  - 微信支付选项：带图标和描述
  - 支付宝选项：带图标和描述
  - 选中状态视觉反馈（边框颜色变化）
  
- **支付按钮**：
  - 大尺寸"确认支付"按钮
  - 点击后显示加载状态
  
- **安全提示**：
  - 底部显示"安全支付由Onerway提供保障"文本

**响应式行为**：
- 在移动设备上自动调整为垂直布局
- 输入框和按钮适应屏幕宽度

#### 2.2.2 支付处理流程

**处理中状态页面**：
- 全屏加载指示器
- "正在处理您的支付"文本提示
- "请勿关闭此页面"警告文本

**处理逻辑**：
1. 验证支付链接有效性（状态必须为"活跃"）
2. 验证金额（固定金额或动态金额在有效范围内）
3. 处理支付请求（实际应用中与支付网关交互）
4. 记录交易结果（成功/失败）
5. 更新链接统计数据（访问量、转化次数、交易金额）

**超时处理**：
- 支付处理超过预设时间（如30秒）触发超时处理
- 显示友好错误提示并提供重试选项

#### 2.2.3 支付结果页面

**成功页面**：
- 大型成功图标（绿色对勾）
- "支付成功"标题
- 成功消息文本
- 交易详情卡片：
  - 交易编号
  - 支付金额
  - 支付时间
  - 支付方式
- "下载收据"按钮（PDF格式）
- "返回首页"按钮
- 底部客服联系信息

**失败页面**：
- 大型失败图标（红色叉号）
- "支付失败"标题
- 失败原因描述
- 错误代码显示
- "重新支付"按钮
- "返回首页"按钮
- 底部客服联系信息

### 2.3 数据存储与管理

#### 2.3.1 链接数据结构

```javascript
{
  id: "pl_123456789",        // 唯一标识符
  shortId: "abcd1234",       // 短链接ID（用于URL）
  title: "商品名称",         // 链接标题
  description: "商品描述",   // 可选描述
  imageUrl: "图片URL",       // 可选图片
  amount: {
    type: "FIXED",           // FIXED或DYNAMIC
    value: 99.99,            // 固定金额值
    minValue: 10.00,         // 动态金额最小值
    maxValue: 1000.00,       // 动态金额最大值
    currency: "CNY"          // 货币代码
  },
  validity: {
    type: "PERMANENT",       // PERMANENT或FIXED
    endTime: "2023-12-31",   // 截止日期
    maxUsage: 100            // 最大使用次数
  },
  paymentMethods: ["credit_card", "apple_pay", "local_payments"],
  status: "ACTIVE",          // ACTIVE, DISABLED, EXPIRED
  createdAt: "2023-01-01T12:00:00Z",
  stats: {
    visits: 100,             // 访问次数
    conversions: 50,         // 成功支付次数
    totalAmount: 4999.50     // 总支付金额
  }
}
```


#### 2.3.2 交易数据结构

```javascript
{
  id: "tr_123456789",        // 唯一标识符
  linkId: "pl_123456789",    // 关联的链接ID
  merchantId: "merchant_id", // 商户ID
  amount: 99.99,             // 支付金额
  currency: "CNY",           // 货币代码
  paymentMethod: "credit_card", // 支付方式
  status: "completed",       // 状态：completed, pending, failed
  createdAt: "2023-01-01T12:30:00Z",
  customerInfo: {
    email: "customer@example.com", // 客户邮箱（如有）
    name: "Customer Name"         // 客户姓名（如有）
  }
}
```


## 3. 功能交互流程

### 3.1 商户链接创建流程
1. 商户登录控制台
2. 点击"创建新链接"按钮
3. 填写基本信息（商品名称、描述、上传图片）
4. 设置金额类型（固定/动态）并填写相关数值
5. 配置高级选项（有效期、使用限制、支付方式）
6. 提交表单
7. 系统生成唯一链接ID和短链接
8. 显示成功消息和链接信息（含二维码）
9. 商户可复制链接或直接查看详情

### 3.2 客户支付流程
1. 客户访问支付链接（直接URL或扫描二维码）
2. 系统记录访问并显示支付页面
3. 客户查看商品信息：
   - 固定金额直接显示
   - 动态金额需客户输入金额
4. 客户选择支付方式
5. 点击"确认支付"按钮
6. 显示支付处理中状态
7. 系统处理支付请求并记录结果
8. 根据结果显示成功或失败页面
9. 成功时提供收据下载选项

### 3.3 链接管理流程
1. 商户进入"管理链接"页面
2. 根据需要筛选、搜索或排序链接列表
3. 查看链接基本信息和统计数据
4. 管理操作：
   - 点击链接标题查看详情
   - 点击启用/禁用按钮切换状态
   - 点击删除按钮（需确认）删除链接
5. 进入链接详情页可查看更详细信息和交易记录
6. 在详情页可复制链接、查看二维码、测试链接
7. 可分享链接到各种社交媒体和通讯工具

## 4. 用户界面要求

### 4.1 设计风格
- 采用现代简约设计风格
- 主色调使用Onerway品牌蓝色（#0066FF）
- 强调视觉层次和信息组织
- 确保界面直观易用

### 4.2 响应式设计
- 支持从移动设备到桌面显示器的多种屏幕尺寸
- 关键功能在各种设备上保持可用性
- 移动设备上优化布局和操作方式

### 4.3 可访问性
- 符合WCAG 2.1 AA级标准
- 提供适当的色彩对比度
- 确保键盘可访问性
- 支持屏幕阅读器

## 5. 技术要求与限制

### 5.1 前端技术栈
- 基础：HTML5/CSS3/JavaScript
- 框架选择：
  - 控制台界面：Bootstrap或纯CSS解决方案
  - 客户支付页面：轻量级框架确保快速加载

### 5.2 后端技术要求
- 实际生产环境中需要服务器端支持
- 演示版本使用LocalStorage模拟数据存储
- 支持RESTful API规范设计

### 5.3 功能限制
- 演示版本不执行实际支付处理
- 不包含用户认证系统
- 数据未持久化到服务器

## 6. 质量与性能要求

### 6.1 性能指标
- 支付页面加载时间<2秒
- 支付处理响应时间<5秒
- 控制台页面加载时间<3秒
- 操作响应时间<1秒

### 6.2 兼容性要求
- 支持Chrome、Firefox、Safari、Edge最新版本
- 支持iOS 12+和Android 8+移动浏览器

### 6.3 安全要求
- 支付数据采用HTTPS传输
- 防止XSS和CSRF攻击
- 输入数据合法性验证
- 敏感数据不明文存储

## 7. 验收标准

### 7.1 功能验收标准
- 所有页面和功能按需求文档实现
- 所有交互流程正常工作
- 数据正确保存和显示

### 7.2 界面验收标准
- 视觉设计符合品牌形象
- 响应式布局在多种设备上正常工作
- 无明显视觉缺陷

### 7.3 性能验收标准
- 满足所有性能指标需求
- 在目标浏览器中流畅运行
- 无明显性能瓶颈

## 8. 交付物

1. 完整HTML/CSS/JavaScript源代码
2. 架构和代码文档
3. 使用说明文档
4. 部署指南
5. 测试报告

## 9. 项目风险

1. 性能优化挑战（尤其是移动设备上）
2. 跨浏览器兼容性问题
3. 支付处理集成复杂性（实际生产环境）
4. 安全合规要求